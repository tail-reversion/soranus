% utility.tex
% Copyright (C) 2018-2019 Kelly Smith.
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License (LPPL),
% either version 1.3c of this license or (at your option)
% any later version. The latest version of this license
% is in the file:
%
%   http://www.latex-project.org/lppl.txt
%
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainer of this work is Kelly Smith.
%
% This work consists of the files listed in the README.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Scratch Variables
%

\tl_new:N \l__soranus_tmpa_tl
\tl_new:N \l__soranus_tmpb_tl

\str_new:N \l__soranus_tmpa_str
\str_new:N \l__soranus_tmpb_str

\seq_new:N \l__soranus_tmpa_seq
\seq_new:N \l__soranus_tmpb_seq

\int_new:N \l__soranus_tmpa_int
\int_new:N \l__soranus_tmpb_int

\bool_new:N \l__soranus_tmpa_bool
\bool_new:N \l__soranus_tmpb_bool

\dim_new:N \l__soranus_tmpa_dim
\dim_new:N \l__soranus_tmpb_dim

\skip_new:N \l__soranus_tmpa_skip
\skip_new:N \l__soranus_tmpb_skip

\fp_new:N \l__soranus_tmpa_fp
\fp_new:N \l__soranus_tmpb_fp

\box_new:N \l__soranus_tmpa_box
\box_new:N \l__soranus_tmpb_box
\box_new:N \l__soranus_tmpc_box
\box_new:N \l__soranus_tmpd_box

\coffin_new:N \l__soranus_tmpa_coffin
\coffin_new:N \l__soranus_tmpb_coffin
\coffin_new:N \l__soranus_tmpc_coffin
\coffin_new:N \l__soranus_tmpd_coffin
\coffin_new:N \l__soranus_tmpe_coffin
\coffin_new:N \l__soranus_tmpf_coffin



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Messages
%

\msg_new:nnn { soranus } { unknown-choice }
  { Key~`#1'~given~unknown~value~#2. }



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General Utility Functions
%

% User-friendly commands for rounded dimension scaling.

\NewExpandableDocumentCommand \ScaleToNearestPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2) } }

\NewExpandableDocumentCommand \ScaleToNearestHalfPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2 * 2) / 2 } }

\NewExpandableDocumentCommand \ScaleToNearestQuarterPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2 * 4) / 4 } }

\NewExpandableDocumentCommand \ScaleToNearestEighthPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2 * 8) / 8 } }

\NewExpandableDocumentCommand \ScaleToNearestTenthPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2, 1) } }

\NewExpandableDocumentCommand \ScaleToNearestHundredthPoint { m m }
  { \fp_to_dim:n { round(\dim_to_fp:n { #1 } * #2, 2) } }


% Command for printing booleans.
\cs_new:Nn \soranus_bool_to_text:n { \bool_if:nTF { #1 } { true } { false } }


% Command for showing a dim in pt//in//mm
\cs_new:Nn \__soranus_for_msg_dim_to_decimal_in_common_units:n
  {
    \iow_newline:
    \iow_indent:n
      {
        \dim_to_decimal:n { #1 } pt
        \iow_char:N \ 
        \iow_char:N \ 
        \dim_to_decimal_in_unit:nn { #1 } { 1in } in
        \iow_char:N \ 
        \iow_char:N \ 
        \dim_to_decimal_in_unit:nn { #1 } { 1mm } mm
      }
  }

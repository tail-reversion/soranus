% fontsize.tex
% Copyright (C) 2018-2020 Kelly Smith.
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License (LPPL),
% either version 1.3c of this license or (at your option)
% any later version. The latest version of this license
% is in the file:
%
%   http://www.latex-project.org/lppl.txt
%
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainer of this work is Kelly Smith.
%
% This work consists of the files listed in the README.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Font Size Setters
%

% I forbid normal font size switches in the middle of a math environment.
\msg_new:nnn { soranus } { fontsize-in-math-mode }
  { Normal~font~size~commands~are~forbidden~in~math~mode. }

% A general function to set font sizes.
\cs_new_protected:Nn \__soranus_set_fontsize:nn
  {
    \mode_if_math:TF
      { \msg_error:nn { soranus } { fontsize-in-math-mode } }
      {
        % I do not use \@setfontsize since I handle math mode in my own way
        % and because \@currsize is not used in this class.
        \exp_args:Nxx \fontsize
          { \dim_eval:n { #1 } }
          { \dim_eval:n { #2 } }
        \selectfont
      }
  }


% Needs reworking.
\cs_new_protected:Nn \__soranus_set_root_relative_fontsize:n
  {
    \__soranus_set_fontsize:nn
      { \g__soranus_normal_point_size_dim * #1}
      { \g__soranus_normal_baseline_scale_fp * #1 }
  }


\cs_new_protected:Nn \__soranus_set_relative_fontsize:n
  {
    \__soranus_set_fontsize:nn
      { \f@size pt * #1 }
      { \f@baselineskip * #1 }
  }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Designer Interface
%

\NewDocumentCommand \AbsoluteFontSize { m m }
  { \__soranus_set_fontsize:nn { #1 } { #2 } }

%\NewDocumentCommand \RootRelativeFontSize { m }
%  { \__soranus_set_root_relative_fontsize:n { #1 } }

\NewDocumentCommand \RelativeFontSize { m }
  { \__soranus_set_relative_fontsize:n { #1 } }



%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%
% Normal Size
%
% Only \normalsize is defined, to keep 2e happy, otherwise templates are used.

\RenewDocumentCommand \normalsize { }
  { \AbsoluteFontSize { 10pt } { 12pt } }
